generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  id         String   @id @db.VarChar(255)
  last_login DateTime @default(now()) @db.Timestamptz()
  login      String   @unique @db.VarChar(255)
  name       String   @db.VarChar(255)
  avatar_url String?
  email      String?  @db.VarChar(255)
  role       String?  @db.VarChar(255)
}

enum ChatRole {
  user
  assistant
}

model message_ai_chat {
  message_id  String             @id @db.VarChar(255)
  user_id     String             @db.VarChar(255)
  create_time DateTime           @default(now()) @db.Timestamptz()
  role        ChatRole
  content     String
  images      message_ai_image[]

  @@index([user_id, create_time(sort: Desc)])
}

model message_ai_image {
  image_id   String          @id @db.VarChar(255)
  message_id String          @db.VarChar(255)
  url        String
  chat       message_ai_chat @relation(fields: [message_id], references: [message_id])

  @@index([message_id])
}
